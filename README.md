# ISAP2
Домашняя работа №2 по "Программирование алгоритмов защиты информации"

Реализовать алгоритм симметричного блочного шифрования camellia и режим работы CBC.

## Ресурсы:
1. RFC 3713: https://tools.ietf.org/html/rfc3713 ;
2. 5528: https://www.ietf.org/rfc/rfc5528.txt?number=5528 ;
3. Официальный сайт camellia: http://info.isl.ntt.co.jp/crypt/eng/camellia/standard.html ;
4. Книга Панасенко С.П. "Алгоритмы шифрования. Специальный справочник" ;
5. "Specification of Camellia", написанная авторами шифра: https://info.isl.ntt.co.jp/crypt/eng/camellia/dl/01espec.pdf ;
6. Инофрмация про режим работы CBC: https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38a.pdf ;

Для реализации была использована библиотека больших чисел libtommath: https://github.com/libtom/libtommath

Для установки библиотеки нужно разархивировать файлы и, зайдя в папку, прописать sudo make install.


## Немного теории
Алгоритм camellia работает с блоками данных размером 128 бит. При это он может использовать ключи длиной 128, 192 и 256 бит. В данной работе будут использоваться ключи размерами 256 и 128.

Алгоритм использует 26 или 34 дополнительных ключа, которые строятся на основе главного ключа. Это просходит с помощью 6 Sigma-переменных, которые всегда одинаковы. 

Также в алгоритме присутствует табличная замена. Она может быть реализована исключительно програмно, но для этого требуется слишком большое количество вычислений, поэтому в программе есть таблица значений.

Реализация CBC хорошо видна на данных картинках:
![image Algorithm CBC Encryption - Decryption](https://github.com/Nasty09/ISAP2/blob/main/CBC%20Encryption%20-%20Decryption.png)

Для этого используется доролнительный IV (вектор инициализации). Благодаря этой системе, каждая следующая группа бит зависет от предыдущей, поэтому, если изменить несколько бит, это сразу же станет заметно, т.к. расшифровать уже не получиться.


## Результаты
Обычный режим работы шифра:

![image Algorithm Camellia](https://github.com/Nasty09/ISAP2/blob/main/Rezults_1.png)

Режим работы CBC:

![image Algorithm CBC Camellia](https://github.com/Nasty09/ISAP2/blob/main/Rezults_2.png)

К сожалению в стандарте 5528 указаны примеры для работы CCM (CBC-MAC), поэтому пришлось проверять отдельно.
